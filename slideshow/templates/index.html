<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
	xmlns:py="http://genshi.edgewall.org/" py:strip="">

	<py:match path="head" once="true">
	<head py:attrs="select('@*')">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<link rel="stylesheet" href="/static/css/common.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="/static/css/main.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="/static/css/jquery-ui-1.8.19.custom.css" type="text/css" media="screen" />
		<script src="/static/js/jquery-1.7.2.min.js" type="text/javascript"></script>
		<script src="/static/js/jquery-ui-1.8.19.custom.min.js" type="text/javascript"></script>
		<script src="/static/js/jquery.jeditable.js" type="text/javascript"></script>
		<script src="/static/js/jquery-foldable-1.0.js" type="text/javascript"></script>
		<script src="/static/js/slideshow.js" type="text/javascript"></script>

		<title py:with="title = list(select('title/text()'))">Slideshow<py:if test="title"> &gt; ${title}</py:if></title>
		${select('*[local-name()!="title"]')}
	</head>
	</py:match>

	<?python
		from slideshow.settings import Settings

		class Menu:
			def __init__(self, *items):
				self.items = items

			def attrs_li(self, i):
				c = []
				if i == 0:
					c.append('first')
				if i == len(self.items) - 1:
					c.append('last')
				if self.items[i][0] == parent:
					c.append('selection')

				return {'class': ' '.join(c)}

			def attrs_a(self, i):
				return {'class': 'menu_' + self.items[i][0]}

		menu = Menu(
			('main', _('main'), '/'),
			('slides', _('slides'), '/slides/upload'),
			('queues', _('queues'), '/queue'),
			('maintenance', _('maintenance'), '/maintenance'))
	?>

	<py:match path="body" once="true">
	<body py:attrs="select('@*')">
		<div id="header">
			<h1>${Settings()['Slideshow.Title']}</h1>
		</div>

		<div id="bar">
			<span class="daemonstatus">Status: ${daemonstr}</span>

			<div id="menu">
				<h2>Menu</h2>
				<ul>
					<py:for each="(i, (_, title, url)) in enumerate(menu.items)">
					<li py:attrs="menu.attrs_li(i)">
						<a href="${url}" py:attrs="menu.attrs_a(i)">${title}</a>
					</li>
					</py:for>
				</ul>
			</div>
		</div>

		<div id="content">
			${select('*|text()')}
		</div>

		<div id="footer">
			<p py:if="username is not None">Logged in as ${username} (<a href="/logout">logout</a>)</p>
			<p>Powered by <a href="http://ext.github.com/slideshow">Slideshow 0.4.1</a></p>
		</div>

	</body>
	</py:match>

</html>
